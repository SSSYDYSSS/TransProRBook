{
  "hash": "8bb7134d2806e96ce1b018662f4985eb",
  "result": {
    "markdown": "# Enrichment Circlize\n::: {.callout-tip}\nIntegrated visualization of different samples, methods, and pathways: Includes specific naming annotations, sorting by the number of enriched genes, and unique arrangement without grouping.\n:::\n\n\n\n\n\n\n\n```r \nlibrary(TransProR)\nlibrary(clusterProfiler)\nlibrary(readr)\nlibrary(GSVA)\nlibrary(fgsea)\nlibrary(stringr)\nlibrary(dplyr)\nlibrary(tidyr)\n```\n\n## geneList \n\n::: {.cell}\n\n```{.r .cell-code}\nDEG_deseq2 <- readRDS('../test_TransProR/Select DEGs/DEG_deseq2.Rdata')\nDEG_edgeR <- readRDS('../test_TransProR/Select DEGs/DEG_edgeR.Rdata')\nDEG_limma_voom <- readRDS('../test_TransProR/Select DEGs/DEG_limma_voom.Rdata')\nWilcoxon_rank_sum_testoutRst <- readRDS('../test_TransProR/Select DEGs/Wilcoxon_rank_sum_testoutRst.Rdata')\n\n\nDEG_deseq2_geneList <- DEG_deseq2$log2FoldChange\nnames(DEG_deseq2_geneList) = row.names(DEG_deseq2)\nDEG_deseq2_geneList = sort(DEG_deseq2_geneList, decreasing = TRUE)\nhead(DEG_deseq2_geneList)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     HTN3 LINC01502     MT-TP      HTN1    MAGEA4  MTRNR2L1 \n 13.30557  13.26522  13.22724  12.69964  12.46226  12.42012 \n```\n:::\n\n```{.r .cell-code}\nDEG_edgeR_geneList <- DEG_edgeR$logFC\nnames(DEG_edgeR_geneList) = row.names(DEG_edgeR)\nDEG_edgeR_geneList = sort(DEG_edgeR_geneList, decreasing = TRUE)\nhead(DEG_edgeR_geneList)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    HTN3    MT-TP   RN7SL2     HTN1    BANCR   MAGEA4 \n14.33849 14.29320 12.44780 12.30199 12.05221 11.96610 \n```\n:::\n\n```{.r .cell-code}\nDEG_limma_voom_geneList <- DEG_limma_voom$logFC\nnames(DEG_limma_voom_geneList) = row.names(DEG_limma_voom)\nDEG_limma_voom_geneList = sort(DEG_limma_voom_geneList, decreasing = TRUE)\nhead(DEG_limma_voom_geneList)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        PRAME         MT-TP RP11-599J14.2        RN7SL2    LHFPL3-AS1 \n    11.897366     10.952225      9.753235      9.524066      9.006715 \n         SPP1 \n     8.678482 \n```\n:::\n\n```{.r .cell-code}\nWilcoxon_rank_sum_testoutRst_geneList <- Wilcoxon_rank_sum_testoutRst$log2foldChange\nnames(Wilcoxon_rank_sum_testoutRst_geneList) = row.names(Wilcoxon_rank_sum_testoutRst)\nWilcoxon_rank_sum_testoutRst_geneList = sort(Wilcoxon_rank_sum_testoutRst_geneList, decreasing = TRUE)\nhead(Wilcoxon_rank_sum_testoutRst_geneList)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   MT-TP    BANCR   RN7SL2    PRAME    IGHGP   MAGEA3 \n13.52891 11.68135 11.67955 11.32951 11.00800 10.93607 \n```\n:::\n:::\n\n\n\n## symbols.gmt\n\n::: {.cell}\n\n```{.r .cell-code}\nhallmarks_pathways <- gmtPathways(\"../gmt/h.all.v7.4.symbols.gmt\")\ngo_pathways <- gmtPathways(\"../gmt/c5.go.v7.4.symbols.gmt\")\nkegg_pathways <- gmtPathways(\"../gmt/c2.cp.kegg.v7.4.symbols.gmt\")\n```\n:::\n\n\n## fgsea:hallmarks/go/kegg\n\n\n\n\n\n\n\n\n\n\n### deseq2\n```r\nset.seed(11)\ndeseq2_hallmarks_fgseaRes <- fgsea(hallmarks_pathways, DEG_deseq2_geneList, minSize=15, maxSize=500, nperm = 10000)\n\n### Calculate genecount\n\ndeseq2_hallmarks_fgseaRes$leadingEdge <- as.character(deseq2_hallmarks_fgseaRes$leadingEdge)\ndeseq2_hallmarks_fgseaRes$genecount <- NA  # Initialize new column\n\nfor(i in 1:nrow(deseq2_hallmarks_fgseaRes)){\n  print(i)\n  term = deseq2_hallmarks_fgseaRes$leadingEdge[i]\n  # 1. Split\n  term_split = unlist(strsplit(term, split=\",\", fixed=TRUE))\n  # Add gene count calculation\n  deseq2_hallmarks_fgseaRes$genecount[i] = length(term_split)\n}\n\nset.seed(12)\ndeseq2_go_fgseaRes <- fgsea(go_pathways, DEG_deseq2_geneList, minSize=15, maxSize=500, nperm = 10000)\n\n### Calculate genecount\n\ndeseq2_go_fgseaRes$leadingEdge <- as.character(deseq2_go_fgseaRes$leadingEdge)\ndeseq2_go_fgseaRes$genecount <- NA  # Initialize new column\n\nfor(i in 1:nrow(deseq2_go_fgseaRes)){\n  print(i)\n  term = deseq2_go_fgseaRes$leadingEdge[i]\n  # 1. Split\n  term_split = unlist(strsplit(term, split=\",\", fixed=TRUE))\n  # Add gene count calculation\n  deseq2_go_fgseaRes$genecount[i] = length(term_split)\n}\n\nset.seed(13)\ndeseq2_kegg_fgseaRes <- fgsea(kegg_pathways, DEG_deseq2_geneList, minSize=15, maxSize=500, nperm = 10000)\n\n### Calculate genecount\n\ndeseq2_kegg_fgseaRes$leadingEdge <- as.character(deseq2_kegg_fgseaRes$leadingEdge)\ndeseq2_kegg_fgseaRes$genecount <- NA  # Initialize new column\n\nfor(i in 1:nrow(deseq2_kegg_fgseaRes)){\n  print(i)\n  term = deseq2_kegg_fgseaRes$leadingEdge[i]\n  # 1. Split\n  term_split = unlist(strsplit(term, split=\",\", fixed=TRUE))\n  # Add gene count calculation\n  deseq2_kegg_fgseaRes$genecount[i] = length(term_split)\n}\n\n```\n\n### edgeR\n```r\nset.seed(21)\nedgeR_hallmarks_fgseaRes <- fgsea(hallmarks_pathways, DEG_edgeR_geneList, minSize=15, maxSize=500, nperm = 10000)\n\n### Calculate genecount\n\nedgeR_hallmarks_fgseaRes$leadingEdge <- as.character(edgeR_hallmarks_fgseaRes$leadingEdge)\nedgeR_hallmarks_fgseaRes$genecount <- NA  # Initialize new column\n\nfor(i in 1:nrow(edgeR_hallmarks_fgseaRes)){\n  print(i)\n  term = edgeR_hallmarks_fgseaRes$leadingEdge[i]\n  # 1. Split\n  term_split = unlist(strsplit(term, split=\",\", fixed=TRUE))\n  # Add gene count calculation\n  edgeR_hallmarks_fgseaRes$genecount[i] = length(term_split)\n}\n\nset.seed(22)\nedgeR_go_fgseaRes <- fgsea(go_pathways, DEG_edgeR_geneList, minSize=15, maxSize=500, nperm = 10000)\n\n### Calculate genecount\n\nedgeR_go_fgseaRes$leadingEdge <- as.character(edgeR_go_fgseaRes$leadingEdge)\nedgeR_go_fgseaRes$genecount <- NA  # Initialize new column\n\nfor(i in 1:nrow(edgeR_go_fgseaRes)){\n  print(i)\n  term = edgeR_go_fgseaRes$leadingEdge[i]\n  # 1. Split\n  term_split = unlist(strsplit(term, split=\",\", fixed=TRUE))\n  # Add gene count calculation\n  edgeR_go_fgseaRes$genecount[i] = length(term_split)\n}\n\nset.seed(23)\nedgeR_kegg_fgseaRes <- fgsea(kegg_pathways, DEG_edgeR_geneList, minSize=15, maxSize=500, nperm = 10000)\n\n### Calculate genecount\n\nedgeR_kegg_fgseaRes$leadingEdge <- as.character(edgeR_kegg_fgseaRes$leadingEdge)\nedgeR_kegg_fgseaRes$genecount <- NA  # Initialize new column\n\nfor(i in 1:nrow(edgeR_kegg_fgseaRes)){\n  print(i)\n  term = edgeR_kegg_fgseaRes$leadingEdge[i]\n  # 1. Split\n  term_split = unlist(strsplit(term, split=\",\", fixed=TRUE))\n  # Add gene count calculation\n  edgeR_kegg_fgseaRes$genecount[i] = length(term_split)\n}\n\n```\n\n### limma\n```r\nset.seed(31)\nlimma_hallmarks_fgseaRes <- fgsea(hallmarks_pathways, DEG_limma_voom_geneList, minSize=15, maxSize=500, nperm = 10000)\n\n### Calculate genecount\n\nlimma_hallmarks_fgseaRes$leadingEdge <- as.character(limma_hallmarks_fgseaRes$leadingEdge)\nlimma_hallmarks_fgseaRes$genecount <- NA  # Initialize new column\n\nfor(i in 1:nrow(limma_hallmarks_fgseaRes)){\n  print(i)\n  term = limma_hallmarks_fgseaRes$leadingEdge[i]\n  # 1. Split\n  term_split = unlist(strsplit(term, split=\",\", fixed=TRUE))\n  # Add gene count calculation\n  limma_hallmarks_fgseaRes$genecount[i] = length(term_split)\n}\n\nset.seed(32)\nlimma_go_fgseaRes <- fgsea(go_pathways, DEG_limma_voom_geneList, minSize=15, maxSize=500, nperm = 10000)\n\n### Calculate genecount\n\nlimma_go_fgseaRes$leadingEdge <- as.character(limma_go_fgseaRes$leadingEdge)\nlimma_go_fgseaRes$genecount <- NA  # Initialize new column\n\nfor(i in 1:nrow(limma_go_fgseaRes)){\n  print(i)\n  term = limma_go_fgseaRes$leadingEdge[i]\n  # 1. Split\n  term_split = unlist(strsplit(term, split=\",\", fixed=TRUE))\n  # Add gene count calculation\n  limma_go_fgseaRes$genecount[i] = length(term_split)\n}\n\nset.seed(33)\nlimma_kegg_fgseaRes <- fgsea(kegg_pathways, DEG_limma_voom_geneList, minSize=15, maxSize=500, nperm = 10000)\n\n### Calculate genecount\n\nlimma_kegg_fgseaRes$leadingEdge <- as.character(limma_kegg_fgseaRes$leadingEdge)\nlimma_kegg_fgseaRes$genecount <- NA  # Initialize new column\n\nfor(i in 1:nrow(limma_kegg_fgseaRes)){\n  print(i)\n  term = limma_kegg_fgseaRes$leadingEdge[i]\n  # 1. Split\n  term_split = unlist(strsplit(term, split=\",\", fixed=TRUE))\n  # Add gene count calculation\n  limma_kegg_fgseaRes$genecount[i] = length(term_split)\n}\n```\n\n## Adjustment\n### deseq2\n```r\nresult <- adjust_export_pathway(fgseaRes =deseq2_hallmarks_fgseaRes, nTop = 10)\ndeseq2_hallmarks_UpDown_topPathways <- result$combinedPathways\ndeseq2_hallmarks_fgseaRes <- result$fgseaRes\n```\n\n```r\nresult <- adjust_export_pathway(fgseaRes =deseq2_go_fgseaRes, nTop = 100)\ndeseq2_go_UpDown_topPathways <- result$combinedPathways\ndeseq2_go_fgseaRes <- result$fgseaRes\n```\n\n```r\nresult <- adjust_export_pathway(fgseaRes =deseq2_kegg_fgseaRes, nTop = 10)\ndeseq2_kegg_UpDown_topPathways <- result$combinedPathways\ndeseq2_kegg_fgseaRes <- result$fgseaRes\n```\n\n\n### edgeR\n```r\nresult <- adjust_export_pathway(fgseaRes =edgeR_hallmarks_fgseaRes, nTop = 10)\nedgeR_hallmarks_UpDown_topPathways <- result$combinedPathways\nedgeR_hallmarks_fgseaRes <- result$fgseaRes\n```\n\n```r\nresult <- adjust_export_pathway(fgseaRes =edgeR_go_fgseaRes, nTop = 100)\nedgeR_go_UpDown_topPathways <- result$combinedPathways\nedgeR_go_fgseaRes <- result$fgseaRes\n```\n\n```r\nresult <- adjust_export_pathway(fgseaRes =edgeR_kegg_fgseaRes, nTop = 10)\nedgeR_kegg_UpDown_topPathways <- result$combinedPathways\nedgeR_kegg_fgseaRes <- result$fgseaRes\n```\n\n### limma\n```r\nresult <- adjust_export_pathway(fgseaRes =limma_hallmarks_fgseaRes, nTop = 10)\nlimma_hallmarks_UpDown_topPathways <- result$combinedPathways\nlimma_hallmarks_fgseaRes <- result$fgseaRes\n```\n\n```r\nresult <- adjust_export_pathway(fgseaRes =limma_go_fgseaRes, nTop = 100)\nlimma_go_UpDown_topPathways <- result$combinedPathways\nlimma_go_fgseaRes <- result$fgseaRes\n```\n\n```r\nresult <- adjust_export_pathway(fgseaRes =limma_kegg_fgseaRes, nTop = 10)\nlimma_kegg_UpDown_topPathways <- result$combinedPathways\nlimma_kegg_fgseaRes <- result$fgseaRes\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## common_elements\n\n::: {.cell}\n\n```{.r .cell-code}\n# Use Reduce and intersect to calculate the intersection of all vectors\nkegg_UpDown_common_elements <- Reduce(intersect, list(limma_kegg_UpDown_topPathways, \n                                                      edgeR_kegg_UpDown_topPathways, \n                                                      deseq2_kegg_UpDown_topPathways))\n# Print the intersection results\nprint(kegg_UpDown_common_elements)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Primary Immunodeficiency\"                    \n [2] \"Allograft Rejection\"                         \n [3] \"Graft Versus Host Disease\"                   \n [4] \"Autoimmune Thyroid Disease\"                  \n [5] \"Type I Diabetes Mellitus\"                    \n [6] \"Systemic Lupus Erythematosus\"                \n [7] \"Antigen Processing And Presentation\"         \n [8] \"Arachidonic Acid Metabolism\"                 \n [9] \"Metabolism Of Xenobiotics By Cytochrome P450\"\n[10] \"Drug Metabolism Cytochrome P450\"             \n[11] \"Retinol Metabolism\"                          \n```\n:::\n\n```{.r .cell-code}\n# Use Reduce and intersect to calculate the intersection of all vectors\ngo_UpDown_common_elements <- Reduce(intersect, list(limma_go_UpDown_topPathways,\n                                                    edgeR_go_UpDown_topPathways,\n                                                    deseq2_go_UpDown_topPathways))\n# Print the intersection results\nprint(go_UpDown_common_elements)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Mhc Protein Complex\"                                                                                \n [2] \"Mhc Protein Complex Binding\"                                                                        \n [3] \"Peptide Antigen Binding\"                                                                            \n [4] \"Lumenal Side Of Endoplasmic Reticulum Membrane\"                                                     \n [5] \"Tolerance Induction\"                                                                                \n [6] \"T Cell Receptor Complex\"                                                                            \n [7] \"Positive Regulation Of Interleukin 2 Production\"                                                    \n [8] \"Immunoglobulin Complex Circulating\"                                                                 \n [9] \"Regulatory T Cell Differentiation\"                                                                  \n[10] \"Lumenal Side Of Membrane\"                                                                           \n[11] \"Immunoglobulin Receptor Binding\"                                                                    \n[12] \"Positive T Cell Selection\"                                                                          \n[13] \"Regulation Of Natural Killer Cell Mediated Immunity\"                                                \n[14] \"T Cell Mediated Cytotoxicity\"                                                                       \n[15] \"Regulation Of T Cell Receptor Signaling Pathway\"                                                    \n[16] \"Immunological Synapse\"                                                                              \n[17] \"Cellular Defense Response\"                                                                          \n[18] \"T Cell Selection\"                                                                                   \n[19] \"Phagocytosis Recognition\"                                                                           \n[20] \"Negative Regulation Of Viral Genome Replication\"                                                    \n[21] \"Positive Regulation Of Cell Killing\"                                                                \n[22] \"Pigment Biosynthetic Process\"                                                                       \n[23] \"Immunoglobulin Complex\"                                                                             \n[24] \"Regulation Of B Cell Proliferation\"                                                                 \n[25] \"Positive Regulation Of Alpha Beta T Cell Activation\"                                                \n[26] \"Regulation Of Antigen Receptor Mediated Signaling Pathway\"                                          \n[27] \"Regulation Of Complement Activation\"                                                                \n[28] \"Positive Regulation Of Interferon Gamma Production\"                                                 \n[29] \"Regulation Of Leukocyte Mediated Cytotoxicity\"                                                      \n[30] \"Tertiary Granule Membrane\"                                                                          \n[31] \"B Cell Proliferation\"                                                                               \n[32] \"Regulation Of Cell Killing\"                                                                         \n[33] \"Specific Granule Membrane\"                                                                          \n[34] \"Humoral Immune Response Mediated By Circulating Immunoglobulin\"                                     \n[35] \"Positive Regulation Of T Cell Proliferation\"                                                        \n[36] \"B Cell Receptor Signaling Pathway\"                                                                  \n[37] \"Antigen Binding\"                                                                                    \n[38] \"Regulation Of Alpha Beta T Cell Activation\"                                                         \n[39] \"Regulation Of Humoral Immune Response\"                                                              \n[40] \"Complement Activation\"                                                                              \n[41] \"Membrane Invagination\"                                                                              \n[42] \"Positive Regulation Of B Cell Activation\"                                                           \n[43] \"Alpha Beta T Cell Differentiation\"                                                                  \n[44] \"Blood Microparticle\"                                                                                \n[45] \"Positive Regulation Of Leukocyte Mediated Immunity\"                                                 \n[46] \"Epithelial Cell Proliferation\"                                                                      \n[47] \"Endopeptidase Activity\"                                                                             \n[48] \"Fatty Acid Metabolic Process\"                                                                       \n[49] \"Epidermis Development\"                                                                              \n[50] \"Skin Development\"                                                                                   \n[51] \"Epidermal Cell Differentiation\"                                                                     \n[52] \"Contractile Fiber\"                                                                                  \n[53] \"Fat Cell Differentiation\"                                                                           \n[54] \"Keratinocyte Differentiation\"                                                                       \n[55] \"Hormone Metabolic Process\"                                                                          \n[56] \"Serine Hydrolase Activity\"                                                                          \n[57] \"Intermediate Filament Cytoskeleton\"                                                                 \n[58] \"Keratinization\"                                                                                     \n[59] \"Response To Xenobiotic Stimulus\"                                                                    \n[60] \"Intermediate Filament\"                                                                              \n[61] \"Striated Muscle Cell Development\"                                                                   \n[62] \"Primary Alcohol Metabolic Process\"                                                                  \n[63] \"Cellular Component Assembly Involved In Morphogenesis\"                                              \n[64] \"Skin Epidermis Development\"                                                                         \n[65] \"Desmosome\"                                                                                          \n[66] \"Regulation Of Water Loss Via Skin\"                                                                  \n[67] \"Aromatase Activity\"                                                                                 \n[68] \"Cell Cell Junction\"                                                                                 \n[69] \"Regulation Of Systemic Arterial Blood Pressure\"                                                     \n[70] \"Epithelial Cell Development\"                                                                        \n[71] \"Oxidoreductase Activity Acting On Paired Donors With Incorporation Or Reduction Of Molecular Oxygen\"\n[72] \"Lipid Catabolic Process\"                                                                            \n[73] \"Cellular Modified Amino Acid Metabolic Process\"                                                     \n[74] \"Heart Morphogenesis\"                                                                                \n[75] \"Cell Cell Junction Organization\"                                                                    \n[76] \"Cardiac Muscle Tissue Development\"                                                                  \n```\n:::\n\n```{.r .cell-code}\n# Use Reduce and intersect to calculate the intersection of all vectors\nhallmarks_UpDown_common_elements <- Reduce(intersect, list(limma_hallmarks_UpDown_topPathways,\n                                                          edgeR_hallmarks_UpDown_topPathways,\n                                                          deseq2_hallmarks_UpDown_topPathways))\n# Print the intersection results\nprint(hallmarks_UpDown_common_elements)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Interferon Alpha Response\"         \"Allograft Rejection\"              \n [3] \"Complement\"                        \"Inflammatory Response\"            \n [5] \"Interferon Gamma Response\"         \"G2m Checkpoint\"                   \n [7] \"E2f Targets\"                       \"Il6 Jak Stat3 Signaling\"          \n [9] \"Estrogen Response Early\"           \"Estrogen Response Late\"           \n[11] \"Myogenesis\"                        \"Kras Signaling Dn\"                \n[13] \"P53 Pathway\"                       \"Hypoxia\"                          \n[15] \"Epithelial Mesenchymal Transition\" \"Apical Junction\"                  \n[17] \"Xenobiotic Metabolism\"            \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Randomly select 10 pathways from the provided list, ensuring that each pathway name does not exceed 10 words.\nhallmarks_selected_pathways <- selectPathways(hallmarks_UpDown_common_elements, max_words = 10, num_select = 10)\nprint(hallmarks_selected_pathways)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Complement\"                \"Estrogen Response Late\"   \n [3] \"Kras Signaling Dn\"         \"Allograft Rejection\"      \n [5] \"P53 Pathway\"               \"Myogenesis\"               \n [7] \"Interferon Gamma Response\" \"G2m Checkpoint\"           \n [9] \"Estrogen Response Early\"   \"Interferon Alpha Response\"\n```\n:::\n\n```{.r .cell-code}\ngo_selected_pathways <- selectPathways(go_UpDown_common_elements, max_words = 10, num_select = 10)\nprint(go_selected_pathways)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Epidermal Cell Differentiation\"                 \n [2] \"Alpha Beta T Cell Differentiation\"              \n [3] \"Desmosome\"                                      \n [4] \"Membrane Invagination\"                          \n [5] \"Regulation Of Water Loss Via Skin\"              \n [6] \"Regulation Of T Cell Receptor Signaling Pathway\"\n [7] \"Positive Regulation Of B Cell Activation\"       \n [8] \"Immunological Synapse\"                          \n [9] \"Intermediate Filament Cytoskeleton\"             \n[10] \"Skin Development\"                               \n```\n:::\n\n```{.r .cell-code}\nkegg_selected_pathways <- selectPathways(kegg_UpDown_common_elements, max_words = 10, num_select = 10)\nprint(kegg_selected_pathways)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Metabolism Of Xenobiotics By Cytochrome P450\"\n [2] \"Retinol Metabolism\"                          \n [3] \"Primary Immunodeficiency\"                    \n [4] \"Allograft Rejection\"                         \n [5] \"Type I Diabetes Mellitus\"                    \n [6] \"Autoimmune Thyroid Disease\"                  \n [7] \"Drug Metabolism Cytochrome P450\"             \n [8] \"Systemic Lupus Erythematosus\"                \n [9] \"Arachidonic Acid Metabolism\"                 \n[10] \"Antigen Processing And Presentation\"         \n```\n:::\n:::\n\n\n## Merge data\n### Hallmarks\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter data\ndeseq2_hallmarks_filtered_fgseaRes <- deseq2_hallmarks_fgseaRes[deseq2_hallmarks_fgseaRes$pathway %in% hallmarks_selected_pathways, ]\n# Select 'pathway' and 'genecount' columns\ndeseq2_hallmarks_filtered_10fgseaRes <- deseq2_hallmarks_filtered_fgseaRes[, c(\"pathway\", \"genecount\")]\n# Print results\nprint(deseq2_hallmarks_filtered_10fgseaRes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                      pathway genecount\n                       <char>     <int>\n 1:            G2m Checkpoint       113\n 2:   Estrogen Response Early        71\n 3:    Estrogen Response Late        70\n 4:                Myogenesis        56\n 5: Interferon Alpha Response        53\n 6: Interferon Gamma Response        99\n 7:                Complement        81\n 8:               P53 Pathway        52\n 9:       Allograft Rejection        83\n10:         Kras Signaling Dn        65\n```\n:::\n\n```{.r .cell-code}\ncolnames(deseq2_hallmarks_filtered_10fgseaRes) <- c(\"pathway\", \"deseq2\")\n\n# Filter data\nedgeR_hallmarks_filtered_fgseaRes <- edgeR_hallmarks_fgseaRes[edgeR_hallmarks_fgseaRes$pathway %in% hallmarks_selected_pathways, ]\n# Select 'pathway' and 'genecount' columns\nedgeR_hallmarks_filtered_10fgseaRes <- edgeR_hallmarks_filtered_fgseaRes[, c(\"pathway\", \"genecount\")]\n# Print results\nprint(edgeR_hallmarks_filtered_10fgseaRes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                      pathway genecount\n                       <char>     <int>\n 1:            G2m Checkpoint       112\n 2:   Estrogen Response Early        70\n 3:    Estrogen Response Late        68\n 4:                Myogenesis        59\n 5: Interferon Alpha Response        50\n 6: Interferon Gamma Response        95\n 7:                Complement        79\n 8:               P53 Pathway        52\n 9:       Allograft Rejection        82\n10:         Kras Signaling Dn        54\n```\n:::\n\n```{.r .cell-code}\ncolnames(edgeR_hallmarks_filtered_10fgseaRes) <- c(\"pathway\", \"edgeR\")\n\n# Filter data\nlimma_hallmarks_filtered_fgseaRes <- limma_hallmarks_fgseaRes[limma_hallmarks_fgseaRes$pathway %in% hallmarks_selected_pathways, ]\n# Select 'pathway' and 'genecount' columns\nlimma_hallmarks_filtered_10fgseaRes <- limma_hallmarks_filtered_fgseaRes[, c(\"pathway\", \"genecount\")]\n# Print results\nprint(limma_hallmarks_filtered_10fgseaRes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                      pathway genecount\n                       <char>     <int>\n 1:            G2m Checkpoint        70\n 2:   Estrogen Response Early        74\n 3:    Estrogen Response Late        67\n 4:                Myogenesis        62\n 5: Interferon Alpha Response        52\n 6: Interferon Gamma Response        86\n 7:                Complement        56\n 8:               P53 Pathway        61\n 9:       Allograft Rejection        88\n10:         Kras Signaling Dn        63\n```\n:::\n\n```{.r .cell-code}\ncolnames(limma_hallmarks_filtered_10fgseaRes) <- c(\"pathway\", \"limma\")\n\n# Use full_join to merge dataframes\nhallmarks_combined_df <- deseq2_hallmarks_filtered_10fgseaRes %>%\n  full_join(edgeR_hallmarks_filtered_10fgseaRes, by = \"pathway\") %>%\n  full_join(limma_hallmarks_filtered_10fgseaRes, by = \"pathway\")\n\n# View the merged dataframe\nprint(hallmarks_combined_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                      pathway deseq2 edgeR limma\n                       <char>  <int> <int> <int>\n 1:            G2m Checkpoint    113   112    70\n 2:   Estrogen Response Early     71    70    74\n 3:    Estrogen Response Late     70    68    67\n 4:                Myogenesis     56    59    62\n 5: Interferon Alpha Response     53    50    52\n 6: Interferon Gamma Response     99    95    86\n 7:                Complement     81    79    56\n 8:               P53 Pathway     52    52    61\n 9:       Allograft Rejection     83    82    88\n10:         Kras Signaling Dn     65    54    63\n```\n:::\n\n```{.r .cell-code}\n# Add a prefix \"hallmarks.\" to the pathway column\nhallmarks_combined_df <- hallmarks_combined_df %>%\n  mutate(pathway = paste(\"Hallmarks.\", pathway))\n\n# Print the modified dataframe to view results\nprint(hallmarks_combined_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                 pathway deseq2 edgeR limma\n                                  <char>  <int> <int> <int>\n 1:            Hallmarks. G2m Checkpoint    113   112    70\n 2:   Hallmarks. Estrogen Response Early     71    70    74\n 3:    Hallmarks. Estrogen Response Late     70    68    67\n 4:                Hallmarks. Myogenesis     56    59    62\n 5: Hallmarks. Interferon Alpha Response     53    50    52\n 6: Hallmarks. Interferon Gamma Response     99    95    86\n 7:                Hallmarks. Complement     81    79    56\n 8:               Hallmarks. P53 Pathway     52    52    61\n 9:       Hallmarks. Allograft Rejection     83    82    88\n10:         Hallmarks. Kras Signaling Dn     65    54    63\n```\n:::\n:::\n\n\n### GO\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter data\ndeseq2_go_filtered_fgseaRes <- deseq2_go_fgseaRes[deseq2_go_fgseaRes$pathway %in% go_selected_pathways, ]\n# Select 'pathway' and 'genecount' columns\ndeseq2_go_filtered_10fgseaRes <- deseq2_go_filtered_fgseaRes[, c(\"pathway\", \"genecount\")]\n# Print results\nprint(deseq2_go_filtered_10fgseaRes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                            pathway genecount\n                                             <char>     <int>\n 1:                  Epidermal Cell Differentiation       209\n 2:                           Membrane Invagination        60\n 3:               Regulation Of Water Loss Via Skin        18\n 4:                                Skin Development       224\n 5:               Alpha Beta T Cell Differentiation        43\n 6: Regulation Of T Cell Receptor Signaling Pathway        19\n 7:        Positive Regulation Of B Cell Activation        76\n 8:                           Immunological Synapse        21\n 9:                                       Desmosome        14\n10:              Intermediate Filament Cytoskeleton       128\n```\n:::\n\n```{.r .cell-code}\ncolnames(deseq2_go_filtered_10fgseaRes) <- c(\"pathway\", \"deseq2\")\n\n# Filter data\nedgeR_go_filtered_fgseaRes <- edgeR_go_fgseaRes[edgeR_go_fgseaRes$pathway %in% go_selected_pathways, ]\n# Select 'pathway' and 'genecount' columns\nedgeR_go_filtered_10fgseaRes <- edgeR_go_filtered_fgseaRes[, c(\"pathway\", \"genecount\")]\n# Print results\nprint(edgeR_go_filtered_10fgseaRes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                            pathway genecount\n                                             <char>     <int>\n 1:                  Epidermal Cell Differentiation       204\n 2:                           Membrane Invagination        58\n 3:               Regulation Of Water Loss Via Skin        18\n 4:                                Skin Development       216\n 5:               Alpha Beta T Cell Differentiation        44\n 6: Regulation Of T Cell Receptor Signaling Pathway        19\n 7:        Positive Regulation Of B Cell Activation        68\n 8:                           Immunological Synapse        21\n 9:                                       Desmosome        14\n10:              Intermediate Filament Cytoskeleton       131\n```\n:::\n\n```{.r .cell-code}\ncolnames(edgeR_go_filtered_10fgseaRes) <- c(\"pathway\", \"edgeR\")\n\n# Filter data\nlimma_go_filtered_fgseaRes <- limma_go_fgseaRes[limma_go_fgseaRes$pathway %in% go_selected_pathways, ]\n# Select 'pathway' and 'genecount' columns\nlimma_go_filtered_10fgseaRes <- limma_go_filtered_fgseaRes[, c(\"pathway\", \"genecount\")]\n# Print results\nprint(limma_go_filtered_10fgseaRes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                            pathway genecount\n                                             <char>     <int>\n 1:                  Epidermal Cell Differentiation       117\n 2:                           Membrane Invagination        42\n 3:               Regulation Of Water Loss Via Skin        14\n 4:                                Skin Development       136\n 5:               Alpha Beta T Cell Differentiation        36\n 6: Regulation Of T Cell Receptor Signaling Pathway        17\n 7:        Positive Regulation Of B Cell Activation        46\n 8:                           Immunological Synapse        21\n 9:                                       Desmosome        12\n10:              Intermediate Filament Cytoskeleton        48\n```\n:::\n\n```{.r .cell-code}\ncolnames(limma_go_filtered_10fgseaRes) <- c(\"pathway\", \"limma\")\n\nlibrary(dplyr)\n# Use full_join to merge dataframes\ngo_combined_df <- deseq2_go_filtered_10fgseaRes %>%\n  full_join(edgeR_go_filtered_10fgseaRes, by = \"pathway\") %>%\n  full_join(limma_go_filtered_10fgseaRes, by = \"pathway\")\n\n# View the merged dataframe\nprint(go_combined_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                            pathway deseq2 edgeR limma\n                                             <char>  <int> <int> <int>\n 1:                  Epidermal Cell Differentiation    209   204   117\n 2:                           Membrane Invagination     60    58    42\n 3:               Regulation Of Water Loss Via Skin     18    18    14\n 4:                                Skin Development    224   216   136\n 5:               Alpha Beta T Cell Differentiation     43    44    36\n 6: Regulation Of T Cell Receptor Signaling Pathway     19    19    17\n 7:        Positive Regulation Of B Cell Activation     76    68    46\n 8:                           Immunological Synapse     21    21    21\n 9:                                       Desmosome     14    14    12\n10:              Intermediate Filament Cytoskeleton    128   131    48\n```\n:::\n\n```{.r .cell-code}\n# Add a prefix \"GO.\" to the pathway column\ngo_combined_df <- go_combined_df %>%\n  mutate(pathway = paste(\"GO.\", pathway))\n\n# Print the modified dataframe to view results\nprint(go_combined_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                                pathway deseq2 edgeR limma\n                                                 <char>  <int> <int> <int>\n 1:                  GO. Epidermal Cell Differentiation    209   204   117\n 2:                           GO. Membrane Invagination     60    58    42\n 3:               GO. Regulation Of Water Loss Via Skin     18    18    14\n 4:                                GO. Skin Development    224   216   136\n 5:               GO. Alpha Beta T Cell Differentiation     43    44    36\n 6: GO. Regulation Of T Cell Receptor Signaling Pathway     19    19    17\n 7:        GO. Positive Regulation Of B Cell Activation     76    68    46\n 8:                           GO. Immunological Synapse     21    21    21\n 9:                                       GO. Desmosome     14    14    12\n10:              GO. Intermediate Filament Cytoskeleton    128   131    48\n```\n:::\n:::\n\n\n### KEGG\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter data\ndeseq2_kegg_filtered_fgseaRes <- deseq2_kegg_fgseaRes[deseq2_kegg_fgseaRes$pathway %in% kegg_selected_pathways, ]\n# Select 'pathway' and 'genecount' columns\ndeseq2_kegg_filtered_10fgseaRes <- deseq2_kegg_filtered_fgseaRes[, c(\"pathway\", \"genecount\")]\n# Print results\nprint(deseq2_kegg_filtered_10fgseaRes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                         pathway genecount\n                                          <char>     <int>\n 1:                  Arachidonic Acid Metabolism        25\n 2:                 Systemic Lupus Erythematosus        25\n 3:                     Primary Immunodeficiency        22\n 4:                           Retinol Metabolism        31\n 5: Metabolism Of Xenobiotics By Cytochrome P450        37\n 6:              Drug Metabolism Cytochrome P450        37\n 7:          Antigen Processing And Presentation        54\n 8:                     Type I Diabetes Mellitus        28\n 9:                   Autoimmune Thyroid Disease        26\n10:                          Allograft Rejection        27\n```\n:::\n\n```{.r .cell-code}\ncolnames(deseq2_kegg_filtered_10fgseaRes) <- c(\"pathway\", \"deseq2\")\n\n# Filter data\nedgeR_kegg_filtered_fgseaRes <- edgeR_kegg_fgseaRes[edgeR_kegg_fgseaRes$pathway %in% kegg_selected_pathways, ]\n# Select 'pathway' and 'genecount' columns\nedgeR_kegg_filtered_10fgseaRes <- edgeR_kegg_filtered_fgseaRes[, c(\"pathway\", \"genecount\")]\n# Print results\nprint(edgeR_kegg_filtered_10fgseaRes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                         pathway genecount\n                                          <char>     <int>\n 1:                  Arachidonic Acid Metabolism        23\n 2:                 Systemic Lupus Erythematosus        27\n 3:                     Primary Immunodeficiency        22\n 4:                           Retinol Metabolism        30\n 5: Metabolism Of Xenobiotics By Cytochrome P450        36\n 6:              Drug Metabolism Cytochrome P450        36\n 7:          Antigen Processing And Presentation        43\n 8:                     Type I Diabetes Mellitus        27\n 9:                   Autoimmune Thyroid Disease        25\n10:                          Allograft Rejection        26\n```\n:::\n\n```{.r .cell-code}\ncolnames(edgeR_kegg_filtered_10fgseaRes) <- c(\"pathway\", \"edgeR\")\n\n# Filter data\nlimma_kegg_filtered_fgseaRes <- limma_kegg_fgseaRes[limma_kegg_fgseaRes$pathway %in% kegg_selected_pathways, ]\n# Select 'pathway' and 'genecount' columns\nlimma_kegg_filtered_10fgseaRes <- limma_kegg_filtered_fgseaRes[, c(\"pathway\", \"genecount\")]\n# Print results\nprint(limma_kegg_filtered_10fgseaRes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                         pathway genecount\n                                          <char>     <int>\n 1:                  Arachidonic Acid Metabolism        19\n 2:                 Systemic Lupus Erythematosus        26\n 3:                     Primary Immunodeficiency        16\n 4:                           Retinol Metabolism        19\n 5: Metabolism Of Xenobiotics By Cytochrome P450        22\n 6:              Drug Metabolism Cytochrome P450        24\n 7:          Antigen Processing And Presentation        35\n 8:                     Type I Diabetes Mellitus        26\n 9:                   Autoimmune Thyroid Disease        25\n10:                          Allograft Rejection        24\n```\n:::\n\n```{.r .cell-code}\ncolnames(limma_kegg_filtered_10fgseaRes) <- c(\"pathway\", \"limma\")\n\nlibrary(dplyr)\n# Use full_join to merge dataframes\nkegg_combined_df <- deseq2_kegg_filtered_10fgseaRes %>%\n  full_join(edgeR_kegg_filtered_10fgseaRes, by = \"pathway\") %>%\n  full_join(limma_kegg_filtered_10fgseaRes, by = \"pathway\")\n\n# View the merged dataframe\nprint(kegg_combined_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                         pathway deseq2 edgeR limma\n                                          <char>  <int> <int> <int>\n 1:                  Arachidonic Acid Metabolism     25    23    19\n 2:                 Systemic Lupus Erythematosus     25    27    26\n 3:                     Primary Immunodeficiency     22    22    16\n 4:                           Retinol Metabolism     31    30    19\n 5: Metabolism Of Xenobiotics By Cytochrome P450     37    36    22\n 6:              Drug Metabolism Cytochrome P450     37    36    24\n 7:          Antigen Processing And Presentation     54    43    35\n 8:                     Type I Diabetes Mellitus     28    27    26\n 9:                   Autoimmune Thyroid Disease     26    25    25\n10:                          Allograft Rejection     27    26    24\n```\n:::\n\n```{.r .cell-code}\n# Add a prefix \"KEGG.\" to the pathway column\nkegg_combined_df <- kegg_combined_df %>%\n  mutate(pathway = paste(\"KEGG.\", pathway))\n\n# Print the modified dataframe to view results\nprint(kegg_combined_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                               pathway deseq2 edgeR limma\n                                                <char>  <int> <int> <int>\n 1:                  KEGG. Arachidonic Acid Metabolism     25    23    19\n 2:                 KEGG. Systemic Lupus Erythematosus     25    27    26\n 3:                     KEGG. Primary Immunodeficiency     22    22    16\n 4:                           KEGG. Retinol Metabolism     31    30    19\n 5: KEGG. Metabolism Of Xenobiotics By Cytochrome P450     37    36    22\n 6:              KEGG. Drug Metabolism Cytochrome P450     37    36    24\n 7:          KEGG. Antigen Processing And Presentation     54    43    35\n 8:                     KEGG. Type I Diabetes Mellitus     28    27    26\n 9:                   KEGG. Autoimmune Thyroid Disease     26    25    25\n10:                          KEGG. Allograft Rejection     27    26    24\n```\n:::\n:::\n\n\n\n### Calculate the total number of genes\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the total number of genes across different samples/methods for the same pathway\n# Add 'hallmarks_count' column to the dataframe\nhallmarks_combined_count_df <- hallmarks_combined_df %>%\n  mutate(hallmarks_count = rowSums(select(., deseq2, edgeR, limma), na.rm = TRUE))\nhallmarks_combined_count_df <- hallmarks_combined_count_df %>%\n  arrange(hallmarks_count)  # Sort in ascending order by default\nprint(hallmarks_combined_count_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                 pathway deseq2 edgeR limma hallmarks_count\n                                  <char>  <int> <int> <int>           <num>\n 1: Hallmarks. Interferon Alpha Response     53    50    52             155\n 2:               Hallmarks. P53 Pathway     52    52    61             165\n 3:                Hallmarks. Myogenesis     56    59    62             177\n 4:         Hallmarks. Kras Signaling Dn     65    54    63             182\n 5:    Hallmarks. Estrogen Response Late     70    68    67             205\n 6:   Hallmarks. Estrogen Response Early     71    70    74             215\n 7:                Hallmarks. Complement     81    79    56             216\n 8:       Hallmarks. Allograft Rejection     83    82    88             253\n 9: Hallmarks. Interferon Gamma Response     99    95    86             280\n10:            Hallmarks. G2m Checkpoint    113   112    70             295\n```\n:::\n\n```{.r .cell-code}\n# Calculate the total number of genes across different samples/methods for the same pathway\n# Add 'go_count' column to the dataframe\ngo_combined_count_df <- go_combined_df %>%\n  mutate(go_count = rowSums(select(., deseq2, edgeR, limma), na.rm = TRUE))\ngo_combined_count_df <- go_combined_count_df %>%\n  arrange(go_count)  # Sort in ascending order by default\nprint(go_combined_count_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                                pathway deseq2 edgeR limma\n                                                 <char>  <int> <int> <int>\n 1:                                       GO. Desmosome     14    14    12\n 2:               GO. Regulation Of Water Loss Via Skin     18    18    14\n 3: GO. Regulation Of T Cell Receptor Signaling Pathway     19    19    17\n 4:                           GO. Immunological Synapse     21    21    21\n 5:               GO. Alpha Beta T Cell Differentiation     43    44    36\n 6:                           GO. Membrane Invagination     60    58    42\n 7:        GO. Positive Regulation Of B Cell Activation     76    68    46\n 8:              GO. Intermediate Filament Cytoskeleton    128   131    48\n 9:                  GO. Epidermal Cell Differentiation    209   204   117\n10:                                GO. Skin Development    224   216   136\n    go_count\n       <num>\n 1:       40\n 2:       50\n 3:       55\n 4:       63\n 5:      123\n 6:      160\n 7:      190\n 8:      307\n 9:      530\n10:      576\n```\n:::\n\n```{.r .cell-code}\n# Calculate the total number of genes across different samples/methods for the same pathway\n# Add 'kegg_count' column to the dataframe\nkegg_combined_count_df <- kegg_combined_df %>%\n  mutate(kegg_count = rowSums(select(., deseq2, edgeR, limma), na.rm = TRUE))\nkegg_combined_count_df <- kegg_combined_count_df %>%\n  arrange(kegg_count)  # Sort in ascending order by default\nprint(kegg_combined_count_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                               pathway deseq2 edgeR limma\n                                                <char>  <int> <int> <int>\n 1:                     KEGG. Primary Immunodeficiency     22    22    16\n 2:                  KEGG. Arachidonic Acid Metabolism     25    23    19\n 3:                   KEGG. Autoimmune Thyroid Disease     26    25    25\n 4:                          KEGG. Allograft Rejection     27    26    24\n 5:                 KEGG. Systemic Lupus Erythematosus     25    27    26\n 6:                           KEGG. Retinol Metabolism     31    30    19\n 7:                     KEGG. Type I Diabetes Mellitus     28    27    26\n 8: KEGG. Metabolism Of Xenobiotics By Cytochrome P450     37    36    22\n 9:              KEGG. Drug Metabolism Cytochrome P450     37    36    24\n10:          KEGG. Antigen Processing And Presentation     54    43    35\n    kegg_count\n         <num>\n 1:         60\n 2:         67\n 3:         76\n 4:         77\n 5:         78\n 6:         80\n 7:         81\n 8:         95\n 9:         97\n10:        132\n```\n:::\n:::\n\n\n## Convert to long format\n\n::: {.cell}\n\n```{.r .cell-code}\n# Use pivot_longer to convert from wide to long format\nkegg_long_df <- kegg_combined_count_df %>%\n  pivot_longer(\n    cols = c(limma, deseq2, edgeR, kegg_count),\n    names_to = \"method/group\",\n    values_to = \"genecount\"\n  )\n# Print the transformed long format dataframe\nprint(kegg_long_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 40 × 3\n   pathway                           `method/group` genecount\n   <chr>                             <chr>              <dbl>\n 1 KEGG. Primary Immunodeficiency    limma                 16\n 2 KEGG. Primary Immunodeficiency    deseq2                22\n 3 KEGG. Primary Immunodeficiency    edgeR                 22\n 4 KEGG. Primary Immunodeficiency    kegg_count            60\n 5 KEGG. Arachidonic Acid Metabolism limma                 19\n 6 KEGG. Arachidonic Acid Metabolism deseq2                25\n 7 KEGG. Arachidonic Acid Metabolism edgeR                 23\n 8 KEGG. Arachidonic Acid Metabolism kegg_count            67\n 9 KEGG. Autoimmune Thyroid Disease  limma                 25\n10 KEGG. Autoimmune Thyroid Disease  deseq2                26\n# ℹ 30 more rows\n```\n:::\n\n```{.r .cell-code}\n# Use pivot_longer to convert from wide to long format\ngo_long_df <- go_combined_count_df %>%\n  pivot_longer(\n    cols = c(limma, deseq2, edgeR, go_count),\n    names_to = \"method/group\",\n    values_to = \"genecount\"\n  )\n# Print the transformed long format dataframe\nprint(go_long_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 40 × 3\n   pathway                                             `method/group` genecount\n   <chr>                                               <chr>              <dbl>\n 1 GO. Desmosome                                       limma                 12\n 2 GO. Desmosome                                       deseq2                14\n 3 GO. Desmosome                                       edgeR                 14\n 4 GO. Desmosome                                       go_count              40\n 5 GO. Regulation Of Water Loss Via Skin               limma                 14\n 6 GO. Regulation Of Water Loss Via Skin               deseq2                18\n 7 GO. Regulation Of Water Loss Via Skin               edgeR                 18\n 8 GO. Regulation Of Water Loss Via Skin               go_count              50\n 9 GO. Regulation Of T Cell Receptor Signaling Pathway limma                 17\n10 GO. Regulation Of T Cell Receptor Signaling Pathway deseq2                19\n# ℹ 30 more rows\n```\n:::\n\n```{.r .cell-code}\n# Use pivot_longer to convert from wide to long format\nhallmarks_long_df <- hallmarks_combined_count_df %>%\n  pivot_longer(\n    cols = c(limma, deseq2, edgeR, hallmarks_count),\n    names_to = \"method/group\",\n    values_to = \"genecount\"\n  )\n# Print the transformed long format dataframe\nprint(hallmarks_long_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 40 × 3\n   pathway                              `method/group`  genecount\n   <chr>                                <chr>               <dbl>\n 1 Hallmarks. Interferon Alpha Response limma                  52\n 2 Hallmarks. Interferon Alpha Response deseq2                 53\n 3 Hallmarks. Interferon Alpha Response edgeR                  50\n 4 Hallmarks. Interferon Alpha Response hallmarks_count       155\n 5 Hallmarks. P53 Pathway               limma                  61\n 6 Hallmarks. P53 Pathway               deseq2                 52\n 7 Hallmarks. P53 Pathway               edgeR                  52\n 8 Hallmarks. P53 Pathway               hallmarks_count       165\n 9 Hallmarks. Myogenesis                limma                  62\n10 Hallmarks. Myogenesis                deseq2                 56\n# ℹ 30 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Use rbind to merge these three dataframes\nall_combined_df <- rbind(kegg_long_df, hallmarks_long_df, go_long_df)\n# Print the merged dataframe to check the results\nprint(all_combined_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 120 × 3\n   pathway                           `method/group` genecount\n   <chr>                             <chr>              <dbl>\n 1 KEGG. Primary Immunodeficiency    limma                 16\n 2 KEGG. Primary Immunodeficiency    deseq2                22\n 3 KEGG. Primary Immunodeficiency    edgeR                 22\n 4 KEGG. Primary Immunodeficiency    kegg_count            60\n 5 KEGG. Arachidonic Acid Metabolism limma                 19\n 6 KEGG. Arachidonic Acid Metabolism deseq2                25\n 7 KEGG. Arachidonic Acid Metabolism edgeR                 23\n 8 KEGG. Arachidonic Acid Metabolism kegg_count            67\n 9 KEGG. Autoimmune Thyroid Disease  limma                 25\n10 KEGG. Autoimmune Thyroid Disease  deseq2                26\n# ℹ 110 more rows\n```\n:::\n\n```{.r .cell-code}\ncolnames(all_combined_df) <- c(\"from\", \"to\", \"value\")\n\n# Extract and deduplicate the 'from' column\nunique_from <- unique(all_combined_df$from)\nprint(\"Unique 'from' values:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Unique 'from' values:\"\n```\n:::\n\n```{.r .cell-code}\nprint(unique_from)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"KEGG. Primary Immunodeficiency\"                     \n [2] \"KEGG. Arachidonic Acid Metabolism\"                  \n [3] \"KEGG. Autoimmune Thyroid Disease\"                   \n [4] \"KEGG. Allograft Rejection\"                          \n [5] \"KEGG. Systemic Lupus Erythematosus\"                 \n [6] \"KEGG. Retinol Metabolism\"                           \n [7] \"KEGG. Type I Diabetes Mellitus\"                     \n [8] \"KEGG. Metabolism Of Xenobiotics By Cytochrome P450\" \n [9] \"KEGG. Drug Metabolism Cytochrome P450\"              \n[10] \"KEGG. Antigen Processing And Presentation\"          \n[11] \"Hallmarks. Interferon Alpha Response\"               \n[12] \"Hallmarks. P53 Pathway\"                             \n[13] \"Hallmarks. Myogenesis\"                              \n[14] \"Hallmarks. Kras Signaling Dn\"                       \n[15] \"Hallmarks. Estrogen Response Late\"                  \n[16] \"Hallmarks. Estrogen Response Early\"                 \n[17] \"Hallmarks. Complement\"                              \n[18] \"Hallmarks. Allograft Rejection\"                     \n[19] \"Hallmarks. Interferon Gamma Response\"               \n[20] \"Hallmarks. G2m Checkpoint\"                          \n[21] \"GO. Desmosome\"                                      \n[22] \"GO. Regulation Of Water Loss Via Skin\"              \n[23] \"GO. Regulation Of T Cell Receptor Signaling Pathway\"\n[24] \"GO. Immunological Synapse\"                          \n[25] \"GO. Alpha Beta T Cell Differentiation\"              \n[26] \"GO. Membrane Invagination\"                          \n[27] \"GO. Positive Regulation Of B Cell Activation\"       \n[28] \"GO. Intermediate Filament Cytoskeleton\"             \n[29] \"GO. Epidermal Cell Differentiation\"                 \n[30] \"GO. Skin Development\"                               \n```\n:::\n\n```{.r .cell-code}\n# Extract and deduplicate the 'to' column\nunique_to <- unique(all_combined_df$to)\nprint(\"Unique 'to' values:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Unique 'to' values:\"\n```\n:::\n\n```{.r .cell-code}\nprint(unique_to)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"limma\"           \"deseq2\"          \"edgeR\"           \"kegg_count\"     \n[5] \"hallmarks_count\" \"go_count\"       \n```\n:::\n:::\n\n\n\n## Enrichment Circlize\n### prepare data\n\n::: {.cell}\n\n```{.r .cell-code}\noriginal_colors <- c(\n  `KEGG. Primary Immunodeficiency` = \"#0d47a1\",\n  `KEGG. Arachidonic Acid Metabolism` = \"#2058ab\",\n  `KEGG. Autoimmune Thyroid Disease` = \"#3469b5\",\n  `KEGG. Allograft Rejection` = \"#4779bf\",\n  `KEGG. Systemic Lupus Erythematosus` = \"#5a8ac9\",\n  `KEGG. Retinol Metabolism` = \"#6e9bd3\",\n  `KEGG. Type I Diabetes Mellitus` = \"#81acdd\",\n  `KEGG. Metabolism Of Xenobiotics By Cytochrome P450` = \"#94bce7\",\n  `KEGG. Drug Metabolism Cytochrome P450` = \"#a8cdf1\",\n  `KEGG. Antigen Processing And Presentation` = \"#bbdefb\",\n  `Hallmarks. Interferon Alpha Response` = \"#1b5e20\",\n  `Hallmarks. P53 Pathway` = \"#2e6d33\",\n  `Hallmarks. Myogenesis` = \"#417c46\",\n  `Hallmarks. Kras Signaling Dn` = \"#558b58\",\n  `Hallmarks. Estrogen Response Late` = \"#689a6b\",\n  `Hallmarks. Estrogen Response Early` = \"#7baa7e\",\n  `Hallmarks. Complement` = \"#8eb991\",\n  `Hallmarks. Allograft Rejection` = \"#a2c8a3\",\n  `Hallmarks. Interferon Gamma Response` = \"#b5d7b6\",\n  `Hallmarks. G2m Checkpoint` = \"#c8e6c9\",\n  `GO. Desmosome` = \"#ff6f00\",\n  `GO. Regulation Of Water Loss Via Skin` = \"#ff7d14\",\n  `GO. Regulation Of T Cell Receptor Signaling Pathway` = \"#ff8b28\",\n  `GO. Immunological Synapse` = \"#ff993c\",\n  `GO. Alpha Beta T Cell Differentiation` = \"#ffa750\",\n  `GO. Membrane Invagination` = \"#ffb463\",\n  `GO. Positive Regulation Of B Cell Activation` = \"#ffc277\",\n  `GO. Intermediate Filament Cytoskeleton` = \"#ffd08b\",\n  `GO. Epidermal Cell Differentiation` = \"#ffde9f\",\n  `GO. Skin Development` = \"#ffecb3\",\n  `limma` = \"#ab47bc\",\n  `deseq2` = \"#7e57c2\",\n  `edgeR` = \"#3f51b5\",\n  `kegg_count` = \"#4979bb\",\n  `hallmarks_count` = \"#6a9a6f\",\n  `go_count` = \"#fda85d\"\n)\nlabels <- c(\n  \"KEGG. Primary Immunodeficiency\",                     \n  \"KEGG. Arachidonic Acid Metabolism\",                  \n  \"KEGG. Autoimmune Thyroid Disease\",                   \n  \"KEGG. Allograft Rejection\",                          \n  \"KEGG. Systemic Lupus Erythematosus\",                 \n  \"KEGG. Retinol Metabolism\",                           \n  \"KEGG. Type I Diabetes Mellitus\",                     \n  \"KEGG. Metabolism Of Xenobiotics By Cytochrome P450\", \n  \"KEGG. Drug Metabolism Cytochrome P450\",              \n  \"KEGG. Antigen Processing And Presentation\",          \n  \"Hallmarks. Interferon Alpha Response\",               \n  \"Hallmarks. P53 Pathway\",                             \n  \"Hallmarks. Myogenesis\",                              \n  \"Hallmarks. Kras Signaling Dn\",                       \n  \"Hallmarks. Estrogen Response Late\",                  \n  \"Hallmarks. Estrogen Response Early\",                 \n  \"Hallmarks. Complement\",                              \n  \"Hallmarks. Allograft Rejection\",                     \n  \"Hallmarks. Interferon Gamma Response\",               \n  \"Hallmarks. G2m Checkpoint\",                          \n  \"GO. Desmosome\",                                      \n  \"GO. Regulation Of Water Loss Via Skin\",              \n  \"GO. Regulation Of T Cell Receptor Signaling Pathway\",\n  \"GO. Immunological Synapse\",                          \n  \"GO. Alpha Beta T Cell Differentiation\",              \n  \"GO. Membrane Invagination\",                         \n  \"GO. Positive Regulation Of B Cell Activation\",       \n  \"GO. Intermediate Filament Cytoskeleton\",             \n  \"GO. Epidermal Cell Differentiation\",                 \n  \"GO. Skin Development\"                  \n)\n\n# 定义颜色\ncolors <- c(\n  \"#0d47a1\",\n  \"#2058ab\",\n  \"#3469b5\",\n  \"#4779bf\",\n  \"#5a8ac9\",\n  \"#6e9bd3\",\n  \"#81acdd\",\n  \"#94bce7\",\n  \"#a8cdf1\",\n  \"#bbdefb\",\n  \"#1b5e20\",\n  \"#2e6d33\",\n  \"#417c46\",\n  \"#558b58\",\n  \"#689a6b\",\n  \"#7baa7e\",\n  \"#8eb991\",\n  \"#a2c8a3\",\n  \"#b5d7b6\",\n  \"#c8e6c9\",\n  \"#ff6f00\",\n  \"#ff7d14\",\n  \"#ff8b28\",\n  \"#ff993c\",\n  \"#ffa750\",\n  \"#ffb463\",\n  \"#ffc277\",\n  \"#ffd08b\",\n  \"#ffde9f\",\n  \"#ffecb3\"\n)\nlabels2 <- c(\"limma\",\n            \"deseq2\",\n            \"edgeR\",\n            \"kegg_count\",\n            \"hallmarks_count\",\n            \"go_count\")\ncolors2 <- c(\"#ab47bc\",\n            \"#7e57c2\",\n            \"#3f51b5\",\n            \"#4979bb\",\n            \"#6a9a6f\",\n            \"#fda85d\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nenrichment_circlize(all_combined_df, original_colors, labels, colors, labels2, colors2, font_size = 10)\n```\n\n::: {.cell-output-display}\n![](Enrichment-Circlize_files/figure-html/unnamed-chunk-24-1.png){width=100%}\n:::\n:::\n\n\n## Reference\n>\n> - **ggplot2**:\n> \n>><a href=\"https://github.com/tidyverse/ggplot2\" style=\"color: #758b76; font-weight: bold;\">github:ggplot2</a>\n>>\n>><a href=\"https://ggplot2.tidyverse.org/\" style=\"color: #758b76; font-weight: bold;\">An implementation of the Grammar of Graphics in R</a>\n>\n> - **GSVA**:\n> \n>><a href=\"https://github.com/rcastelo/GSVA\" style=\"color: #758b76; font-weight: bold;\">GSVA: gene set variation analysis for microarray and RNA-seq data</a>\n>\n> - **fgsea**:\n> \n>><a href=\"https://github.com/ctlab/fgsea\" style=\"color: #758b76; font-weight: bold;\">fgsea is an R-package for fast preranked gene set enrichment analysis (GSEA). </a>\n>\n> - **clusterProfiler 4.0**:\n> \n>><a href=\"https://doi.org/10.1016/j.xinn.2021.100141\" style=\"color: #758b76; font-weight: bold;\">T Wu#, E Hu#, S Xu, M Chen, P Guo, Z Dai, T Feng, L Zhou, W Tang, L Zhan, X Fu, S Liu, X Bo*, G Yu*. clusterProfiler 4.0: A universal enrichment tool for interpreting omics data. The Innovation. 2021, 2(3):100141. </a>\n>\n> - **circlize**:\n> \n>><a href=\"https://academic.oup.com/bioinformatics/article/30/19/2811/2422259?login=false\" style=\"color: #758b76; font-weight: bold;\">Zuguang Gu, et al., circlize Implements and enhances circular visualization in R. Bioinformatics (Oxford, England) 2014.</a>\n> ",
    "supporting": [
      "Enrichment-Circlize_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}